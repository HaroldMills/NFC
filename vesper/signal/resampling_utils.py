"""
Utilities for resampling audio.

This module currently contains just one function, called
`resample_to_24000_hz`, that resamples audio from any sample rate to
24000 Hz. The function offers fast, high quality resampling (using
multirate, polyphase FIR filtering) of input at 22000, 32000, 44000, or
48000 Hz, and falls back on `resampy` for other rates, including 22050
and 44100 Hz. The function was developed for use with NFC detectors that
require 24000 Hz input (or close to that) and ignore the portion of the
input above 11000 Hz. For the input sample rates for which the function
uses polyphase filtering, the output has high quality up to 11000 Hz,
but not above that.
"""


import resampy
import scipy.signal as signal
 

# TODO: Create `Resampler` class whose instances can resample a signal
# in chunks, producing the same samples that would be produced if the
# signal was processed all at once.

# TODO: Try using combined fractional delay/lowpass filters designed
# as such rather than multirate polyphase filters derived from a single
# lowpass filter for resampling.

 
def resample_to_24000_hz(samples, input_rate):
    
    case = _24000_HZ_SPECIAL_CASES.get(float(input_rate))

    if case is not None:
        # input rate is a special case for which we can resample
        # efficiently using a polyphase filter
        
        up, down, filter_ = case
        # print('Resampling from {} Hz to 24000 Hz...'.format(input_rate))
        return signal.resample_poly(samples, up, down, window=filter_)
    
    else:
        return resampy.resample(samples, input_rate, 24000)
         
            
# FIR filter for downsampling to 24 kHz by a factor of 2, designed with
# http://t-filter.appspot.com
# 
# sampling frequency: 48000 Hz
# 
# * 0 Hz - 11000 Hz
#   gain = 1
#   desired ripple = 0.1 dB
#   actual ripple = 0.07021746492897468 dB
# 
# * 13000 Hz - 24000 Hz
#   gain = 0
#   desired attenuation = -130 dB
#   actual attenuation = -130.42425512250503 dB
#
# filter length: 121
_FILTER_2 = [
    0.000009684173574608177,
    0.00008902167556384223,
    0.0003395205679166055,
    0.0007268510148241687,
    0.0009003654621573075,
    0.0004744637666800852,
    -0.00030521426492852833,
    -0.0005605542656804068,
    0.000052542525215201936,
    0.0005868731570929838,
    0.00010227537246720766,
    -0.0006492368431232539,
    -0.0002665849115370235,
    0.0007322932882572647,
    0.0004775247962381272,
    -0.0008139189983642926,
    -0.0007495316802412728,
    0.0008743938065721137,
    0.00108855402839856,
    -0.0008966720466679922,
    -0.0014982661140733006,
    0.000863555241746325,
    0.0019811717791075913,
    -0.0007554083683797881,
    -0.0025365171626908125,
    0.0005516940128694578,
    0.0031608299196254994,
    -0.00023197127471919044,
    -0.0038506139912031436,
    -0.00022748764425022745,
    0.004600434968171682,
    0.0008545792371211404,
    -0.005400064139736417,
    -0.0016775167652689276,
    0.006239768493114445,
    0.0027305246157869954,
    -0.007108227380206567,
    -0.004056722202465221,
    0.007989107951167215,
    0.0057054958245764545,
    -0.008869989012492998,
    -0.00774894235989201,
    0.009732292529452114,
    0.01028291438470285,
    -0.010561440254406201,
    -0.013456373219257299,
    0.011340339876430544,
    0.017506476777962902,
    -0.012052945528816557,
    -0.022843991521198148,
    0.012684703600096837,
    0.03025029025004986,
    -0.01322175677864686,
    -0.04140837006691816,
    0.013652370535886547,
    0.06071279897861917,
    -0.013967034558265262,
    -0.10431516765560593,
    0.014158663982349445,
    0.31771068753447423,
    0.48577692994890126,
    0.31771068753447423,
    0.014158663982349445,
    -0.10431516765560593,
    -0.013967034558265262,
    0.06071279897861917,
    0.013652370535886547,
    -0.04140837006691816,
    -0.01322175677864686,
    0.03025029025004986,
    0.012684703600096837,
    -0.022843991521198148,
    -0.012052945528816557,
    0.017506476777962902,
    0.011340339876430544,
    -0.013456373219257299,
    -0.010561440254406201,
    0.01028291438470285,
    0.009732292529452114,
    -0.00774894235989201,
    -0.008869989012492998,
    0.0057054958245764545,
    0.007989107951167215,
    -0.004056722202465221,
    -0.007108227380206567,
    0.0027305246157869954,
    0.006239768493114445,
    -0.0016775167652689276,
    -0.005400064139736417,
    0.0008545792371211404,
    0.004600434968171682,
    -0.00022748764425022745,
    -0.0038506139912031436,
    -0.00023197127471919044,
    0.0031608299196254994,
    0.0005516940128694578,
    -0.0025365171626908125,
    -0.0007554083683797881,
    0.0019811717791075913,
    0.000863555241746325,
    -0.0014982661140733006,
    -0.0008966720466679922,
    0.00108855402839856,
    0.0008743938065721137,
    -0.0007495316802412728,
    -0.0008139189983642926,
    0.0004775247962381272,
    0.0007322932882572647,
    -0.0002665849115370235,
    -0.0006492368431232539,
    0.00010227537246720766,
    0.0005868731570929838,
    0.000052542525215201936,
    -0.0005605542656804068,
    -0.00030521426492852833,
    0.0004744637666800852,
    0.0009003654621573075,
    0.0007268510148241687,
    0.0003395205679166055,
    0.00008902167556384223,
    0.000009684173574608177
]

# FIR filter for downsampling to 24 kHz by a factor of 4, designed with
# http://t-filter.appspot.com
# 
# sampling frequency: 96000 Hz
# 
# * 0 Hz - 11000 Hz
#   gain = 1
#   desired ripple = 0.1 dB
#   actual ripple = 0.07176886849623103 dB
# 
# * 13000 Hz - 48000 Hz
#   gain = 0
#   desired attenuation = -130 dB
#   actual attenuation = -130.2344381717108 dB
#   
# filter length: 241
_FILTER_4 = [
    0.0000021099396923192415,
    0.00000963507678813224,
    0.0000280125638657064,
    0.00006262073433590627,
    0.00011543010153955519,
    0.0001808068756186796,
    0.0002427749294403036,
    0.00027633022116848005,
    0.00025438634364310415,
    0.00015938238028512214,
    -0.000004583294654113291,
    -0.00020532751305441928,
    -0.00038741908778248604,
    -0.0004897172595404059,
    -0.00047069351824482195,
    -0.00033094790075621994,
    -0.00012080986157245019,
    0.00007438556452016754,
    0.00016877665947676723,
    0.00011662858525048841,
    -0.000060554023994690115,
    -0.00027687930823017164,
    -0.0004183783990735897,
    -0.0003989176593838292,
    -0.00020891360444275737,
    0.00007040727282341268,
    0.00029991181674487836,
    0.00035132339574153374,
    0.00017900221572651366,
    -0.0001445926558171377,
    -0.00045445692129896805,
    -0.0005735580884332557,
    -0.0004104536141118106,
    -0.000021267036280749494,
    0.0004036887978581146,
    0.0006308662561961675,
    0.0005103552777026458,
    0.00007105553228841,
    -0.00047411419743705535,
    -0.0008272032118312326,
    -0.0007647322221756085,
    -0.00027384050534663663,
    0.00041576125332320763,
    0.0009348692786114931,
    0.0009697853359707221,
    0.00044805260792892736,
    -0.00039288835074437754,
    -0.0011070829076356816,
    -0.00127253717278024,
    -0.0007357689197274324,
    0.00027102346103461886,
    0.0012217350216400923,
    0.0015670518551488945,
    0.0010474448247987463,
    -0.0001274297147009486,
    -0.0013505487611148747,
    -0.00192557690028204,
    -0.001458102478515166,
    -0.00011295990097263961,
    0.0014245277844835878,
    0.002291072942203641,
    0.0019246316688635633,
    0.0004173937817659623,
    -0.0014736614140918908,
    -0.0026983849698507365,
    -0.002490040659217388,
    -0.0008339046356467161,
    0.0014529784641862658,
    0.0031140815810788837,
    0.0031361369879316673,
    0.001355697831832088,
    -0.0013677286354744648,
    -0.003552413039099167,
    -0.0038911247257795343,
    -0.0020207462463890874,
    0.0011818392855002238,
    0.003991920774139253,
    0.004754065867908859,
    0.00284312623264227,
    -0.0008812313723967754,
    -0.004434916043739705,
    -0.005751278169039663,
    -0.0038658630807659987,
    0.0004260219338873127,
    0.004866303884186458,
    0.006902136863353699,
    0.005131965145842504,
    0.00022214435616361406,
    -0.0052831376217073334,
    -0.00825263256266784,
    -0.006719933317340901,
    -0.0011318690679227238,
    0.0056731545319752795,
    0.009867319362884689,
    0.008745092564515018,
    0.0024014043538841128,
    -0.006031029861226051,
    -0.01186867256187246,
    -0.011415037947842323,
    -0.004206953267733924,
    0.006347680060120484,
    0.014482932982877752,
    0.015119072220692854,
    0.006882486269722207,
    -0.006617111361187537,
    -0.01819009314715197,
    -0.02069926171267628,
    -0.011172936810407203,
    0.0068331166194650714,
    0.02417948336346192,
    0.030352662906276393,
    0.019145475501416067,
    -0.006991176664263886,
    -0.036381034720417565,
    -0.05215547107677558,
    -0.039488219282224075,
    0.0070870984888680546,
    0.07972933552848294,
    0.15885446165505873,
    0.2199398582813843,
    0.24288032475324856,
    0.2199398582813843,
    0.15885446165505873,
    0.07972933552848294,
    0.0070870984888680546,
    -0.039488219282224075,
    -0.05215547107677558,
    -0.036381034720417565,
    -0.006991176664263886,
    0.019145475501416067,
    0.030352662906276393,
    0.02417948336346192,
    0.0068331166194650714,
    -0.011172936810407203,
    -0.02069926171267628,
    -0.01819009314715197,
    -0.006617111361187537,
    0.006882486269722207,
    0.015119072220692854,
    0.014482932982877752,
    0.006347680060120484,
    -0.004206953267733924,
    -0.011415037947842323,
    -0.01186867256187246,
    -0.006031029861226051,
    0.0024014043538841128,
    0.008745092564515018,
    0.009867319362884689,
    0.0056731545319752795,
    -0.0011318690679227238,
    -0.006719933317340901,
    -0.00825263256266784,
    -0.0052831376217073334,
    0.00022214435616361406,
    0.005131965145842504,
    0.006902136863353699,
    0.004866303884186458,
    0.0004260219338873127,
    -0.0038658630807659987,
    -0.005751278169039663,
    -0.004434916043739705,
    -0.0008812313723967754,
    0.00284312623264227,
    0.004754065867908859,
    0.003991920774139253,
    0.0011818392855002238,
    -0.0020207462463890874,
    -0.0038911247257795343,
    -0.003552413039099167,
    -0.0013677286354744648,
    0.001355697831832088,
    0.0031361369879316673,
    0.0031140815810788837,
    0.0014529784641862658,
    -0.0008339046356467161,
    -0.002490040659217388,
    -0.0026983849698507365,
    -0.0014736614140918908,
    0.0004173937817659623,
    0.0019246316688635633,
    0.002291072942203641,
    0.0014245277844835878,
    -0.00011295990097263961,
    -0.001458102478515166,
    -0.00192557690028204,
    -0.0013505487611148747,
    -0.0001274297147009486,
    0.0010474448247987463,
    0.0015670518551488945,
    0.0012217350216400923,
    0.00027102346103461886,
    -0.0007357689197274324,
    -0.00127253717278024,
    -0.0011070829076356816,
    -0.00039288835074437754,
    0.00044805260792892736,
    0.0009697853359707221,
    0.0009348692786114931,
    0.00041576125332320763,
    -0.00027384050534663663,
    -0.0007647322221756085,
    -0.0008272032118312326,
    -0.00047411419743705535,
    0.00007105553228841,
    0.0005103552777026458,
    0.0006308662561961675,
    0.0004036887978581146,
    -0.000021267036280749494,
    -0.0004104536141118106,
    -0.0005735580884332557,
    -0.00045445692129896805,
    -0.0001445926558171377,
    0.00017900221572651366,
    0.00035132339574153374,
    0.00029991181674487836,
    0.00007040727282341268,
    -0.00020891360444275737,
    -0.0003989176593838292,
    -0.0004183783990735897,
    -0.00027687930823017164,
    -0.000060554023994690115,
    0.00011662858525048841,
    0.00016877665947676723,
    0.00007438556452016754,
    -0.00012080986157245019,
    -0.00033094790075621994,
    -0.00047069351824482195,
    -0.0004897172595404059,
    -0.00038741908778248604,
    -0.00020532751305441928,
    -0.000004583294654113291,
    0.00015938238028512214,
    0.00025438634364310415,
    0.00027633022116848005,
    0.0002427749294403036,
    0.0001808068756186796,
    0.00011543010153955519,
    0.00006262073433590627,
    0.0000280125638657064,
    0.00000963507678813224,
    0.0000021099396923192415
]


# FIR filter for downsampling to 24 kHz by a factor of 11, designed with
# http://t-filter.appspot.com
# 
# sampling frequency: 264000 Hz
# 
# * 0 Hz - 11000 Hz
#   gain = 1
#   desired ripple = 0.1 dB
#   actual ripple = 0.07204487930862138 dB
# 
# * 13000 Hz - 132000 Hz
#   gain = 0
#   desired attenuation = -130 dB
#   actual attenuation = -130.18906375235264 dB
#   
# filter length: 663
_FILTER_11 = [
    3.9955636364877033e-7,
    7.448240806273481e-7,
    0.0000014000910325738593,
    0.0000023907093349484813,
    0.0000038119328185230514,
    0.000005764918488339644,
    0.000008351000406462943,
    0.000011664359183426832,
    0.000015783203986271726,
    0.000020759926364473902,
    0.000026610688767472575,
    0.000033305111595714956,
    0.00004075685144310081,
    0.00004881595802133032,
    0.000057263931595841136,
    0.0000658123805986347,
    0.00007410590510145464,
    0.00008172998258705582,
    0.00008822402857533147,
    0.00009309973006677488,
    0.00009586415165844591,
    0.00009604690768778395,
    0.00009323025337548322,
    0.00008708036712890459,
    0.00007737809062177377,
    0.00006404693345787713,
    0.000047176184296232074,
    0.000027036958349869656,
    0.0000040892069062951215,
    -0.00002102178064286896,
    -0.0000474805371073474,
    -0.00007432851871549801,
    -0.00010050269861760213,
    -0.00012488456844555855,
    -0.00014635733909524525,
    -0.00016386852295961665,
    -0.00017649442662770698,
    -0.00018350255489403582,
    -0.0001844077263719736,
    -0.00017901762564525388,
    -0.0001674640379617381,
    -0.00015021644328782612,
    -0.00012807558663488464,
    -0.00010214604952832329,
    -0.0000737877470618444,
    -0.00004454809837431749,
    -0.000016077915406139862,
    0.000009964632690095857,
    0.00003201641305227115,
    0.000048711688335478746,
    0.00005897752211007274,
    0.00006211553832801511,
    0.000057863419708984294,
    0.00004643091598960171,
    0.000028506269023566537,
    0.000005230851900030468,
    -0.000021858052182163728,
    -0.0000509141975822255,
    -0.00007989487750035216,
    -0.00010669225082214005,
    -0.00012927577289137274,
    -0.00014583601288123014,
    -0.00015491993094761278,
    -0.00015554779270472502,
    -0.00014730202491619425,
    -0.00013038080199495247,
    -0.0001056101570856978,
    -0.00007441214097262477,
    -0.000038728680328933826,
    -9.046570362684277e-7,
    0.00003646352468227625,
    0.00007070452879060788,
    0.00009926235334807241,
    0.00011988694186990273,
    0.00013081140274361192,
    0.000130902100673157,
    0.0001197693109998427,
    0.00009782843496987645,
    0.00006630482329717952,
    0.000027179240369802965,
    -0.00001692496452797614,
    -0.00006290722261354533,
    -0.00010739803534731873,
    -0.00014699665127255437,
    -0.00017852181613591556,
    -0.00019925761292872922,
    -0.00020717570445105484,
    -0.0002011163901603042,
    -0.00018091295560422453,
    -0.00014744737024713483,
    -0.00010263007099892672,
    -0.00004930175528028178,
    0.000008938897364940198,
    0.00006797202538575581,
    0.0001234430533438932,
    0.00017107941366056016,
    0.0002070150858607275,
    0.0002280987329428762,
    0.00023216147227266294,
    0.00021822226000660532,
    0.00018661246108603747,
    0.0001390067525962329,
    0.00007835377515239483,
    0.000008707408838236564,
    -0.00006503279093751147,
    -0.0001374563940691917,
    -0.00020302984091228793,
    -0.0002565100882027992,
    -0.0002933536830279357,
    -0.00031009007709660347,
    -0.00030462916433444915,
    -0.00027647677684098173,
    -0.00022683790858589272,
    -0.0001585949456081007,
    -0.00007615738674916614,
    0.000014810959949591617,
    0.00010777148124748665,
    0.00019577266227755456,
    0.0002719621776744163,
    0.00033011265306253127,
    0.0003651206775418302,
    0.0003734407623012832,
    0.0003534173662239336,
    0.0003054862896021094,
    0.00023222424751277875,
    0.0001382367062034338,
    0.000029886384230142794,
    -0.00008512370578793996,
    -0.00019828605759629364,
    -0.0003009071703867315,
    -0.0003847646574658261,
    -0.0004427538540590023,
    -0.0004694740105644024,
    -0.00046170685223037843,
    -0.00041874625552088733,
    -0.00034254815727370646,
    -0.00023768208211976302,
    -0.00011108030549551117,
    0.00002840387603658018,
    0.00017060195557392174,
    0.00030475997013648475,
    0.0004203408697748311,
    0.0005078403326736388,
    0.0005595540063700706,
    0.000570235132671427,
    0.0005375877769769235,
    0.0004625515906832201,
    0.00034934844054116846,
    0.00020527846247891848,
    0.00004027178914516201,
    -0.00013377845613171492,
    -0.0003038585739578056,
    -0.00045679370315873847,
    -0.0005802543634514583,
    -0.0006637343790245844,
    -0.0006994238504734883,
    -0.0006829060051156985,
    -0.0006136176935520241,
    -0.0004950293583118972,
    -0.00033452079114749223,
    -0.00014295142713646603,
    0.00006605281849310223,
    0.0002770512632851065,
    0.0004739137249520756,
    0.0006410382643988477,
    0.0007645708338510124,
    0.0008335330316961528,
    0.0008407675063689034,
    0.0007836213216190366,
    0.0006643052557332211,
    0.0004898907192137378,
    0.0002719316771738485,
    0.00002572715424864738,
    -0.0002307307673980526,
    -0.0004780521196814734,
    -0.000696896545107289,
    -0.0008694671629488517,
    -0.0009809352573562947,
    -0.0010206835230625404,
    -0.0009832678959443707,
    -0.000869011060623705,
    -0.0006841697602603059,
    -0.000440652475300151,
    -0.0001552864599632046,
    0.00015131518257541994,
    0.00045622039993512085,
    0.0007358708726745744,
    0.0009678807269649408,
    0.0011328037749607127,
    0.0012157323672133172,
    0.0012075983459760788,
    0.0011060656374984683,
    0.000915931859404209,
    0.0006489917082254926,
    0.0003233549002978751,
    -0.00003774653194430972,
    -0.0004075860563153065,
    -0.0007578940061401526,
    -0.0010609920036144405,
    -0.0012919514598546593,
    -0.0014306097324879453,
    -0.0014632834583596579,
    -0.0013840365810777898,
    -0.0011953904069621126,
    -0.0009084026729163974,
    -0.0005420889070893135,
    -0.0001222096171636943,
    0.0003205035536984007,
    0.0007525635915762959,
    0.0011402286260015053,
    0.001452103107681647,
    0.001661641532370659,
    0.0017493579062656142,
    0.0017045605892628448,
    0.0015264628985118944,
    0.0012245634881888894,
    0.000818243456947696,
    0.0003355861118010415,
    -0.0001885144422213386,
    -0.0007148326034495736,
    -0.0012027055634976317,
    -0.0016131323419834181,
    -0.001911844514466187,
    -0.0020721102208325916,
    -0.0020770462323861007,
    -0.0019212432698132733,
    -0.0016115568733027265,
    -0.0011669756174973222,
    -0.0006175470182430892,
    -0.0000024135461892912476,
    0.0006329184242750736,
    0.0012398905763319542,
    0.0017705487476274708,
    0.002181271830341223,
    0.0024362880801706865,
    0.0025107002618015733,
    0.002392770091760339,
    0.0020852613410475437,
    0.0016057070982762693,
    0.0009855449608081866,
    0.0002681498898702018,
    -0.000494120408044214,
    -0.001243672119843305,
    -0.0019219516052330276,
    -0.002473939404168435,
    -0.002852522669005206,
    -0.003022405465548974,
    -0.002963239780392423,
    -0.00267171029071717,
    -0.0021623767048179455,
    -0.0014671668313003272,
    -0.0006335133282037975,
    0.0002787688771418563,
    0.001201667809659931,
    0.0020639370922255484,
    0.0027964818146847385,
    0.0033377685892518848,
    0.003638845363945781,
    0.003667572066540097,
    0.0034117096837670323,
    0.0028805905058098985,
    0.002105190784289222,
    0.001136543109950268,
    0.00004255000644780629,
    -0.0010966153650339774,
    -0.0021942213332220854,
    -0.003163407097155858,
    -0.003923864749490866,
    -0.004408273539174849,
    -0.004567986294830008,
    -0.004377506419229996,
    -0.003837368654692947,
    -0.0029751431822842775,
    -0.00184441434254642,
    -0.0005217326638302388,
    0.000898308088964188,
    0.0023095699036449297,
    0.0036020165332434732,
    0.0046699744222813274,
    0.005420409734375154,
    0.00578059790946949,
    0.005704582830323821,
    0.005177889446275999,
    0.004220062217388841,
    0.0028847464748761515,
    0.0012572008817172294,
    -0.0005506850120827514,
    -0.002407606289231956,
    -0.004171854039098242,
    -0.005701534486762513,
    -0.006865294635919751,
    -0.007552786091172449,
    -0.007684084998501624,
    -0.007217328381118937,
    -0.006153924310418903,
    -0.004540840643835357,
    -0.0024696652534283,
    -0.00007234849935965196,
    0.0024862292903608126,
    0.005018490592530259,
    0.007326606629991453,
    0.009216386383924167,
    0.01051170823792595,
    0.011068513545256857,
    0.010787374665333069,
    0.009623702928191081,
    0.007594786803839249,
    0.004783032622068795,
    0.0013350099690907682,
    -0.002543828336642434,
    -0.006598599562398981,
    -0.010538183288086726,
    -0.014051455018550077,
    -0.016825640414667303,
    -0.018565700011002127,
    -0.019013550747397065,
    -0.01796590378391694,
    -0.015289549534861512,
    -0.010933049301177014,
    -0.00493399167283579,
    0.0025787698475601925,
    0.01138818151502522,
    0.02119731536061794,
    0.0316425870350003,
    0.04231118601163251,
    0.05276176671456368,
    0.06254723343398544,
    0.07123830624561864,
    0.07844649079503992,
    0.08384509633996734,
    0.08718705222711076,
    0.08831845773135502,
    0.08718705222711076,
    0.08384509633996734,
    0.07844649079503992,
    0.07123830624561864,
    0.06254723343398544,
    0.05276176671456368,
    0.04231118601163251,
    0.0316425870350003,
    0.02119731536061794,
    0.01138818151502522,
    0.0025787698475601925,
    -0.00493399167283579,
    -0.010933049301177014,
    -0.015289549534861512,
    -0.01796590378391694,
    -0.019013550747397065,
    -0.018565700011002127,
    -0.016825640414667303,
    -0.014051455018550077,
    -0.010538183288086726,
    -0.006598599562398981,
    -0.002543828336642434,
    0.0013350099690907682,
    0.004783032622068795,
    0.007594786803839249,
    0.009623702928191081,
    0.010787374665333069,
    0.011068513545256857,
    0.01051170823792595,
    0.009216386383924167,
    0.007326606629991453,
    0.005018490592530259,
    0.0024862292903608126,
    -0.00007234849935965196,
    -0.0024696652534283,
    -0.004540840643835357,
    -0.006153924310418903,
    -0.007217328381118937,
    -0.007684084998501624,
    -0.007552786091172449,
    -0.006865294635919751,
    -0.005701534486762513,
    -0.004171854039098242,
    -0.002407606289231956,
    -0.0005506850120827514,
    0.0012572008817172294,
    0.0028847464748761515,
    0.004220062217388841,
    0.005177889446275999,
    0.005704582830323821,
    0.00578059790946949,
    0.005420409734375154,
    0.0046699744222813274,
    0.0036020165332434732,
    0.0023095699036449297,
    0.000898308088964188,
    -0.0005217326638302388,
    -0.00184441434254642,
    -0.0029751431822842775,
    -0.003837368654692947,
    -0.004377506419229996,
    -0.004567986294830008,
    -0.004408273539174849,
    -0.003923864749490866,
    -0.003163407097155858,
    -0.0021942213332220854,
    -0.0010966153650339774,
    0.00004255000644780629,
    0.001136543109950268,
    0.002105190784289222,
    0.0028805905058098985,
    0.0034117096837670323,
    0.003667572066540097,
    0.003638845363945781,
    0.0033377685892518848,
    0.0027964818146847385,
    0.0020639370922255484,
    0.001201667809659931,
    0.0002787688771418563,
    -0.0006335133282037975,
    -0.0014671668313003272,
    -0.0021623767048179455,
    -0.00267171029071717,
    -0.002963239780392423,
    -0.003022405465548974,
    -0.002852522669005206,
    -0.002473939404168435,
    -0.0019219516052330276,
    -0.001243672119843305,
    -0.000494120408044214,
    0.0002681498898702018,
    0.0009855449608081866,
    0.0016057070982762693,
    0.0020852613410475437,
    0.002392770091760339,
    0.0025107002618015733,
    0.0024362880801706865,
    0.002181271830341223,
    0.0017705487476274708,
    0.0012398905763319542,
    0.0006329184242750736,
    -0.0000024135461892912476,
    -0.0006175470182430892,
    -0.0011669756174973222,
    -0.0016115568733027265,
    -0.0019212432698132733,
    -0.0020770462323861007,
    -0.0020721102208325916,
    -0.001911844514466187,
    -0.0016131323419834181,
    -0.0012027055634976317,
    -0.0007148326034495736,
    -0.0001885144422213386,
    0.0003355861118010415,
    0.000818243456947696,
    0.0012245634881888894,
    0.0015264628985118944,
    0.0017045605892628448,
    0.0017493579062656142,
    0.001661641532370659,
    0.001452103107681647,
    0.0011402286260015053,
    0.0007525635915762959,
    0.0003205035536984007,
    -0.0001222096171636943,
    -0.0005420889070893135,
    -0.0009084026729163974,
    -0.0011953904069621126,
    -0.0013840365810777898,
    -0.0014632834583596579,
    -0.0014306097324879453,
    -0.0012919514598546593,
    -0.0010609920036144405,
    -0.0007578940061401526,
    -0.0004075860563153065,
    -0.00003774653194430972,
    0.0003233549002978751,
    0.0006489917082254926,
    0.000915931859404209,
    0.0011060656374984683,
    0.0012075983459760788,
    0.0012157323672133172,
    0.0011328037749607127,
    0.0009678807269649408,
    0.0007358708726745744,
    0.00045622039993512085,
    0.00015131518257541994,
    -0.0001552864599632046,
    -0.000440652475300151,
    -0.0006841697602603059,
    -0.000869011060623705,
    -0.0009832678959443707,
    -0.0010206835230625404,
    -0.0009809352573562947,
    -0.0008694671629488517,
    -0.000696896545107289,
    -0.0004780521196814734,
    -0.0002307307673980526,
    0.00002572715424864738,
    0.0002719316771738485,
    0.0004898907192137378,
    0.0006643052557332211,
    0.0007836213216190366,
    0.0008407675063689034,
    0.0008335330316961528,
    0.0007645708338510124,
    0.0006410382643988477,
    0.0004739137249520756,
    0.0002770512632851065,
    0.00006605281849310223,
    -0.00014295142713646603,
    -0.00033452079114749223,
    -0.0004950293583118972,
    -0.0006136176935520241,
    -0.0006829060051156985,
    -0.0006994238504734883,
    -0.0006637343790245844,
    -0.0005802543634514583,
    -0.00045679370315873847,
    -0.0003038585739578056,
    -0.00013377845613171492,
    0.00004027178914516201,
    0.00020527846247891848,
    0.00034934844054116846,
    0.0004625515906832201,
    0.0005375877769769235,
    0.000570235132671427,
    0.0005595540063700706,
    0.0005078403326736388,
    0.0004203408697748311,
    0.00030475997013648475,
    0.00017060195557392174,
    0.00002840387603658018,
    -0.00011108030549551117,
    -0.00023768208211976302,
    -0.00034254815727370646,
    -0.00041874625552088733,
    -0.00046170685223037843,
    -0.0004694740105644024,
    -0.0004427538540590023,
    -0.0003847646574658261,
    -0.0003009071703867315,
    -0.00019828605759629364,
    -0.00008512370578793996,
    0.000029886384230142794,
    0.0001382367062034338,
    0.00023222424751277875,
    0.0003054862896021094,
    0.0003534173662239336,
    0.0003734407623012832,
    0.0003651206775418302,
    0.00033011265306253127,
    0.0002719621776744163,
    0.00019577266227755456,
    0.00010777148124748665,
    0.000014810959949591617,
    -0.00007615738674916614,
    -0.0001585949456081007,
    -0.00022683790858589272,
    -0.00027647677684098173,
    -0.00030462916433444915,
    -0.00031009007709660347,
    -0.0002933536830279357,
    -0.0002565100882027992,
    -0.00020302984091228793,
    -0.0001374563940691917,
    -0.00006503279093751147,
    0.000008707408838236564,
    0.00007835377515239483,
    0.0001390067525962329,
    0.00018661246108603747,
    0.00021822226000660532,
    0.00023216147227266294,
    0.0002280987329428762,
    0.0002070150858607275,
    0.00017107941366056016,
    0.0001234430533438932,
    0.00006797202538575581,
    0.000008938897364940198,
    -0.00004930175528028178,
    -0.00010263007099892672,
    -0.00014744737024713483,
    -0.00018091295560422453,
    -0.0002011163901603042,
    -0.00020717570445105484,
    -0.00019925761292872922,
    -0.00017852181613591556,
    -0.00014699665127255437,
    -0.00010739803534731873,
    -0.00006290722261354533,
    -0.00001692496452797614,
    0.000027179240369802965,
    0.00006630482329717952,
    0.00009782843496987645,
    0.0001197693109998427,
    0.000130902100673157,
    0.00013081140274361192,
    0.00011988694186990273,
    0.00009926235334807241,
    0.00007070452879060788,
    0.00003646352468227625,
    -9.046570362684277e-7,
    -0.000038728680328933826,
    -0.00007441214097262477,
    -0.0001056101570856978,
    -0.00013038080199495247,
    -0.00014730202491619425,
    -0.00015554779270472502,
    -0.00015491993094761278,
    -0.00014583601288123014,
    -0.00012927577289137274,
    -0.00010669225082214005,
    -0.00007989487750035216,
    -0.0000509141975822255,
    -0.000021858052182163728,
    0.000005230851900030468,
    0.000028506269023566537,
    0.00004643091598960171,
    0.000057863419708984294,
    0.00006211553832801511,
    0.00005897752211007274,
    0.000048711688335478746,
    0.00003201641305227115,
    0.000009964632690095857,
    -0.000016077915406139862,
    -0.00004454809837431749,
    -0.0000737877470618444,
    -0.00010214604952832329,
    -0.00012807558663488464,
    -0.00015021644328782612,
    -0.0001674640379617381,
    -0.00017901762564525388,
    -0.0001844077263719736,
    -0.00018350255489403582,
    -0.00017649442662770698,
    -0.00016386852295961665,
    -0.00014635733909524525,
    -0.00012488456844555855,
    -0.00010050269861760213,
    -0.00007432851871549801,
    -0.0000474805371073474,
    -0.00002102178064286896,
    0.0000040892069062951215,
    0.000027036958349869656,
    0.000047176184296232074,
    0.00006404693345787713,
    0.00007737809062177377,
    0.00008708036712890459,
    0.00009323025337548322,
    0.00009604690768778395,
    0.00009586415165844591,
    0.00009309973006677488,
    0.00008822402857533147,
    0.00008172998258705582,
    0.00007410590510145464,
    0.0000658123805986347,
    0.000057263931595841136,
    0.00004881595802133032,
    0.00004075685144310081,
    0.000033305111595714956,
    0.000026610688767472575,
    0.000020759926364473902,
    0.000015783203986271726,
    0.000011664359183426832,
    0.000008351000406462943,
    0.000005764918488339644,
    0.0000038119328185230514,
    0.0000023907093349484813,
    0.0000014000910325738593,
    7.448240806273481e-7,
    3.9955636364877033e-7
]


_24000_HZ_SPECIAL_CASES = {
    22000.: (12, 11, _FILTER_11),
    32000.: (3, 4, _FILTER_4),
    44000.: (6, 11, _FILTER_11),
    48000.: (1, 2, _FILTER_2)
}
"""
Special cases for which we can resample to 24000 Hz efficiently using
a polyphase filter.
"""
